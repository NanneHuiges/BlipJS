/*****

BlipJS v1.0

A dead-simple, client-side way to grab info via the Blipfoto API.

Copyright 2011 Graham Bradley
This work is licensed under a Creative Commons Attribution-Noncommercial 3.0
Unported License (http://creativecommons.org/licenses/by-nc/3.0/).

*****/

(function(G,D){var f='BlipJS',me=function(a,b){this.key=a;this.conf=b||{baseURL:'http://api.blipfoto.com/',version:2,test:0};this._requestID=0};me._sendRequest=function(b,c,d){var e=D.createElement('script'),id=f+b;me._requestCache[id]=function(a){delScript=D.getElementById(id);if(delScript){delScript.parentNode.removeChild(delScript)}delete me._requestCache[id];if(a.error&&a.error.code){if(d.error){d.error(a.error)}}else if(d.complete){d.complete(a.data)}};e.id=id;e.src=c+'&callback='+f+'._requestCache["'+id+'"]';D.getElementsByTagName('head')[0].appendChild(e)};me._requestCache={};me.prototype={get:function(a,b){return this._request('get',a,b)},search:function(a,b,c){return this._request('get','search',{params:['max='+(c||12),'query='+encodeURIComponent(a)],complete:b})},view:function(a,b,c){return this._request('get','view',{params:['max='+(c||12),'view='+a],complete:b})},entry:function(b,c,d){return this._request('get','entry',{params:[(typeof b=='number'?'entry_id=':'entry_date=latest&display_name=')+b,'data='+((d||['display_name','journal_title','entry_id','date','title','image']).join(','))],complete:function(a){c(a[0])}})},_request:function(a,b,c){var c=c||{},url=this.conf.baseURL+a+'/'+b+'/?'+this._getDefaultParams().concat(c.params||[]).join('&');me._sendRequest(this._requestID++,url,c)},_getDefaultParams:function(){var a=['api_key='+this.key,'version='+this.conf.version,'nohttperror=1','format=JSON'];if(this.test){a.push('test=1')}return a}};G[f]=me})(window,document);